// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String   @id @default(cuid())
  email         String   @unique
  passwordHash  String   @map("password_hash")
  role          String   @default("admin") // admin, user
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  passwordResets PasswordResetToken[]

  @@map("users")
}

model Vehicle {
  id          String   @id @default(cuid())
  name        String
  category    String   // SUV, Sedan, Sports
  description String?
  imageUrl    String?  @map("image_url")
  price       Float?
  features    String[] // Array of features
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  bookings Booking[]

  @@map("vehicles")
}

model Service {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  description String?
  imageUrl    String?  @map("image_url")
  features    String[] // Array of features
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@map("services")
}

model Page {
  id        String   @id @default(cuid())
  slug      String   @unique
  title     String
  content   String   @db.Text
  metaTitle String?  @map("meta_title")
  metaDesc  String?  @map("meta_desc") @db.Text
  isActive  Boolean  @default(true) @map("is_active")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("pages")
}

model Booking {
  id          String   @id @default(cuid())
  customerName String  @map("customer_name")
  customerEmail String @map("customer_email")
  customerPhone String @map("customer_phone")
  serviceType String   @map("service_type")
  vehicleId   String?  @map("vehicle_id")
  date        DateTime
  time        String
  pickupLocation String @map("pickup_location")
  destination String?
  message     String?  @db.Text
  status      String   @default("pending") // pending, confirmed, completed, cancelled
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  vehicle Vehicle? @relation(fields: [vehicleId], references: [id])

  @@map("bookings")
}

model Media {
  id        String   @id @default(cuid())
  url       String
  filename  String
  type      String   // image, video, document
  uploadedAt DateTime @default(now()) @map("uploaded_at")

  @@map("media")
}

model PasswordResetToken {
  id        String   @id @default(cuid())
  userId    String   @map("user_id")
  token     String   @unique
  expiresAt DateTime @map("expires_at")
  used      Boolean  @default(false)
  createdAt DateTime @default(now()) @map("created_at")

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("password_reset_tokens")
  @@index([token])
  @@index([userId])
}

model HeroContent {
  id          String   @id @default(cuid())
  title       String
  subtitle    String   @db.Text
  buttonText  String   @default("EXPLORE OUR FLEET") @map("button_text")
  buttonLink  String   @default("/fleet") @map("button_link")
  backgroundImageUrl String? @map("background_image_url")
  overlayOpacity Float  @default(0.4) @map("overlay_opacity")
  isActive    Boolean  @default(true) @map("is_active")
  // Carousel settings
  enableCarousel Boolean @default(false) @map("enable_carousel")
  carouselInterval Int   @default(5000) @map("carousel_interval") // milliseconds
  carouselImages  String[] @default([]) @map("carousel_images") // Array of image URLs
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@map("hero_content")
}

model HomepageSection {
  id          String   @id @default(cuid())
  sectionKey  String   @unique @map("section_key") // luxury-choice, fleet-preview, services-preview
  title       String?
  description String?  @db.Text
  buttonText  String?  @map("button_text")
  buttonLink  String?  @map("button_link")
  isActive    Boolean  @default(true) @map("is_active")
  order       Int      @default(0)
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@map("homepage_sections")
}
